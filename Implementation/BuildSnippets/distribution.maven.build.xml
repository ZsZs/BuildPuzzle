<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE project>
<project name="distribution.maven" basedir="." xmlns:artifact="antlib:org.apache.maven.artifact.ant">
	
   <typedef resource="org/apache/maven/artifact/ant/antlib.xml" uri="urn:maven-artifact-ant" classpath="${ant.tasks.path}/maven-ant-tasks-2.1.3.jar"/> 
	
   <property name="maven.deploy.jar.file" value="${project.distribution.dir}/${component.packaged.file}" />
	
   <target name="maven-deploy" depends="maven-deploy-local, maven-deploy-remote"></target>
	
   <target name="maven-deploy-local" unless="compile.classpath" xmlns:artifact="urn:maven-artifact-ant">    
       <condition property="maven.repository.local" value="${maven.repository.local}" else="${user.home}/.m2/repository">
           <isset property="maven.repository.local"/>
       </condition>           
      
       <artifact:localRepository id="local.repository" path="${maven.repository.local}"/> 
       <artifact:pom file="pom.xml" id="component.pom"/>

       <artifact:install file="${distributed.java.archive.file}">
       	<localRepository refid="local.repository"/>
         <pom refid="component.pom"/>
       </artifact:install>
   </target>
	
	<target name="maven-deploy-remote">
		<artifact:mvn>
		   <arg value="org.apache.maven.plugins:maven-deploy-plugin:2.6:deploy-file" />
		   <arg value="-Durl=${maven.repository.remote}" />
		   <arg value="-DrepositoryId=sonatype-nexus-snapshots" />
		   <arg value="-DpomFile=${distributed.component.maven.file}" />
		   <arg value="-Dfile=${distributed.java.archive.file}" />
	   </artifact:mvn>
	</target>

<!--   
   <target name="maven-deploy-remote">
      <artifact:remoteRepository id="remote.repository" url="${maven.repository.remote}"/> 
      
      <artifact:deploy file="${maven.deploy.jar.file}">
         <remoteRepository refid="remote.repository">
            <authentication username="${maven.repository.remote.user}" password="${maven.repository.remote.password}"/>
         </remoteRepository>
         <pom refid="component.pom"/>
      </artifact:deploy>
   </target>
-->
</project>
